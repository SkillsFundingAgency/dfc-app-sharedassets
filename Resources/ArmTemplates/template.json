{
    "$schema": "https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json",
    "contentVersion": "1.0.0.0",
    "parameters": {
      "cosmosDbName": {
        "type": "string",
        "metadata": {
          "description": "Name of Cosmos DB to create"
        }
      },
      "cosmosApiType": {
        "type": "string",
        "defaultValue": "SQL",
        "metadata": {
          "description": "API type for Cosmos DB"
        }
      },
      "cosmosConsistencyLevel": {
        "type": "string",
        "defaultValue": "?",
        "metadata": {
          "description": "Consistency level for Cosmos DB"
        }
      },
      "cosmosIpWhitelist": {
        "type": "string",
        "defaultValue": "",
        "metadata": {
          "description": "Any additional IP addresses to add to the Cosmos DB IP Range Filter in addition to the default addresses.  If more than 1 address is included they should be seperated by a comma, eg: 11.111.123.134,12.134.114.115"
        }
      }
    },
    "variables": {
      "deploymentUrlBase": "https://raw.githubusercontent.com/SkillsFundingAgency/dfc-devops/master/ArmTemplates/"
    },
    "resources": [
      {
        "name": "appSharedCosmos",
        "type": "Microsoft.Resources/deployments",
        "apiVersion": "2017-05-10",
        "properties": {
          "mode": "Incremental",
          "templateLink": {
            "uri": "[concat(variables('deploymentUrlBase'),'cosmos-db.json')]",
            "contentVersion": "1.0.0.0"
          },
          "parameters": {
            "cosmosDbName": {
              "value": "[parameters('cosmosDbName')]"
            },
            "cosmosApiType": {
              "value": "[parameters('cosmosApiType')]"
            },
            "defaultConsistencyLevel": {
              "value": "[parameters('cosmosConsistencyLevel')]"
            },
            "additionalIpAddresses": {
              "value": "[parameters('cosmosIpWhitelist')]"
            }
          }
        }
      }
    ]
  }